package me.feng3d.lights.shadowmaps
{
	import me.feng3d.cameras.Camera3D;

	/**
	 *
	 * @author warden_feng 2015-5-28
	 */
	public class NearDirectionalShadowMapper extends DirectionalShadowMapper
	{
		private var _coverageRatio:Number;

		public function NearDirectionalShadowMapper(coverageRatio:Number = .5)
		{
			super();
		}

		override protected function updateDepthProjection(viewCamera:Camera3D):void
		{
			var corners:Vector.<Number> = viewCamera.lens.frustumCorners;

			for (var i:int = 0; i < 12; ++i)
			{
				var v:Number = corners[i];
				_localFrustum[i] = v;
				_localFrustum[uint(i + 12)] = v + (corners[uint(i + 12)] - v) * _coverageRatio;
			}

			updateProjectionFromFrustumCorners(viewCamera, _localFrustum, _matrix);
			_overallDepthLens.matrix = _matrix;
		}
	}
}
